#!/bin/sh
# WWW          : https://github.com/wwwsensor/dotfiles
# Author       : @sensor @ss
# Dependencies : grim slurp imagemagick wl-clipboard
#
# Get pixel's color info in Wayland server.

N=/dev/null

# Handle errors
senderr(){ echo pc: "$@";exit 1; }

# Handle dependencies
which grim >$N || senderr grim not found
which slurp >$N || senderr slurp not found
which convert >$N || senderr imagemagick not found
which wl-copy >$N || senderr wl-clipboard not found

# Main
PX=$(slurp -p)
grim -g "$PX" -t ppm - | convert - txt:- &&
grim -g "$PX" -t ppm - | convert - txt:- | tail -n 1 | cut -d' ' -f4 | wl-copy
